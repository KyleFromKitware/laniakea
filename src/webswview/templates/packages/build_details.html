{% extends 'layouts/base.html' %}

{% set page_title = 'Build ' + spkg.name + ' ' + job.version + ' on ' + job.architecture %}

{% block body_header %}
<h2>Build {{spkg.name}} {{job.version}} on {{job.architecture}}</h2>
{% endblock %}

{% block body %}

<b>ID:</b> {{job.uuid}}<br/>
<br/>
<b>Created:</b> {{humanized_timediff(job.time_created)}}<br/>
<b>Assigned:</b> {{humanized_timediff(job.time_assigned)}}<br/>
{% if job.time_finished %}<b>Finished:</b> {{humanized_timediff(job.time_finished)}}<br/>{% endif %}
<br/>
{% if worker %}
<b>Worker:</b> {{worker.name}}<br/>
{% endif %}

<b>Status:</b>
{% if job.status == JobStatus.WAITING %}
  <span style="font-size: 20px; line-height: 1.5em;">
    <i class="fa fa-hourglass-start" aria-hidden="true"></i>
  </span> Waiting
{% elif job.status == JobStatus.SCHEDULED %}
  <span style="font-size: 20px; line-height: 1.5em;">
    <i class="fa fa-circle-o-notch fa-spin" aria-hidden="true"></i>
  </span> Scheduled
{% elif job.status == JobStatus.RUNNING %}
  <span style="font-size: 20px; line-height: 1.5em;">
    <i class="fa fa-cog fa-spin" aria-hidden="true"></i>
  </span> Running
{% elif job.status == JobStatus.DONE %}
  <span style="font-size: 20px; line-height: 1.5em;">
    <i class="fa fa-check" aria-hidden="true"></i>
  </span> Done
{% elif job.status == JobStatus.STARVING %}
  <span style="font-size: 20px; line-height: 1.5em;">
    <i class="fa fa-clock-o" aria-hidden="true"></i>
  </span> Starving
{% elif job.status == JobStatus.TERMINATED %}
  <span style="font-size: 20px; line-height: 1.5em;">
    <i class="fa fa-skull" aria-hidden="true"></i>
  </span> Terminated
{% endif %}
<br/>


<br/>
{% if job.result != JobResult.UNKNOWN %}
<h3>Result</h3>
<p>
{% if job.result == JobResult.SUCCESS_PENDING %}
  <span style="font-size: 20px; line-height: 1.5em;">
    <font class="fa fa-check-circle" aria-hidden="true" color="green"></font>
    <i class="fa fa-clock" aria-hidden="true"></i>
  </span> Successful (pending)
{% elif job.result == JobResult.FAILURE_PENDING %}
  <span style="font-size: 20px; line-height: 1.5em;">
    <font class="fa fa-times-circle" aria-hidden="true" color="red"></font>
    <i class="fa fa-clock" aria-hidden="true"></i>
  </span> Failed (pending)
{% elif job.result == JobResult.SUCCESS %}
  <span style="font-size: 20px; line-height: 1.5em;">
    <font class="fa fa-check-circle" aria-hidden="true" color="green"></font>
  </span> Success
{% elif job.result == JobResult.FAILURE %}
  <span style="font-size: 20px; line-height: 1.5em;">
    <font class="fa fa-times-circle" aria-hidden="true" color="red"></font>
  </span> Failed
{% endif %}
</p>
{% endif %}


<h3>Details</h3>
<p>
<b>Repository:</b> {{spkg.repo.name}}<br/>
<b>Suite:</b> {{suite_name}}<br/>
<b>Maintainer:</b> {{spkg.maintainer.replace('@', '[at]')}}<br/>
{% if spkg.uploaders %}<b>Uploaders:</b> {{'; '.join(spkg.uploaders).replace('@', '[at]')}}<br/>{% endif %}
<b>Version:</b> {{job.version}}<br/>
<b>Architecture:</b> <span class="badge badge-pill badge-secondary"><i class="fas fa-cog"></i> {{job.architecture}}</span><br/>
</p>

{% if log_url %}
<p><a class="btn btn-info" href="{{log_url}}" role="button">View Full Log</a></p>
{% else %}

<h3>Log Excerpt</h3>
<div class="row">
  <div class="col-md-8">
    <div class="card card-body bg-light">
      <pre><code>{{job.latest_log_excerpt if job.latest_log_excerpt else '...'}}</code></pre>
    </div>
  </div>
</div>
{%endif %}

{% endblock %}
